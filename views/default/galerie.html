{{extend 'layout.html'}}

<div id="doi-patru">
	<div id="galerie">

		<div id="grid">
		{{for index,pic in enumerate(pics):}}
			{{=A(IMG(_src=URL('download', args=pic.gray), _alt=pic.title, _class='pic'), _href=URL('panou', args=(pic.id, index+1, len(pics))))}}			
		{{pass}}
		</div>
	</div>
</div>
<div id="doi-doi">
 <div id="panou"></div>
</div>
<div id="trei-trei">
	<div id="progress">
		<img src="{{=URL('static', 'images/progress.gif')}}" alt="progress"/>
	</div>
</div>
<div id="unu-patru">
  {{if tagul: }}
  <span class="current-thing">{{=tagul.name}}</span>
  {{pass}}
</div>

<div id="unu-trei">
  {{if tagul: }}
  <span class="current-thing">
    <a href="{{=URL('galerie', args=project.id)}}">{{=project.name}}</a>
  </span>
  {{pass}}
</div>

<div id="navigator">
  <div id="trei-doi">
    <a id="prev-detail" href="#">
    </a>
  </div>
  <div id="trei-patru">
    <a id="next-detail" href="#"></a>
  </div>
</div>


<script type="text/javascript">
	function updatePrevNext(aObject){
                $("#grid>a>img.current-pic").removeClass("current-pic");
                aObject.children("img.pic").addClass("current-pic");
		var prevImage = aObject.prev("a").attr("href");
		var nextImage = aObject.next("a").attr("href");
		if(prevImage) $("#prev-detail").attr("href", prevImage);
		if(nextImage) $("#next-detail").attr("href", nextImage);
	}
	function showActivity(){$("#progress").show();}
	function hideActivity(){$("#progress").hide();}
	function updateTip() {
		$('#poza-mare[title]').qtip({
			style: {
				classes: "ui-tooltip-tipsy"
			},
			position: {
				at: "bottom center",
				my: "bottom center"
			},
            show: {
                event: 'click mouseenter', // Don't specify a show event...
                ready: true // ... but show the tooltip when ready
            },
		});
	}
	$(function(){
		showActivity();
		var firstLink = $("#grid>a:first");
		$("#panou").load(firstLink.attr("href"));
		updatePrevNext(firstLink);

		$("#grid>a").click(function(e){
			showActivity();
			var clickedLink = $(this);
			$("#panou").load(clickedLink.attr("href"));
			updatePrevNext(clickedLink);
			e.preventDefault();
		});
		$("#prev-detail, #next-detail").click(function(e){
			showActivity();
			var clickedLink = $(this);
			$("#panou").load(clickedLink.attr("href"));
			updatePrevNext($("#grid>a[href='"+clickedLink.attr("href")+"']"));
			e.preventDefault();
		});
	});
</script>
