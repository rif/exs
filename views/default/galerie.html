{{extend 'layout.html'}}

<div id="doi-doi">
	<div id="galerie">
		<div id="grid">
		{{for index,pic in enumerate(pics):}}
			{{=A(IMG(_src=URL('download', args=pic.gray), _alt=pic.title, _class='pic'), _href=URL('panou', args=(pic.id, index+1, len(pics))))}}
		{{pass}}
		</div>
		<div id="panou"></div>
	</div>
</div>

<div id="trei-patru">
	<div id="progress">
		<img src="{{=URL('static', 'images/progress.gif')}}" alt="progress"/>
	</div>
</div>

<div id="doi-cinci">
	<div id="navigator">
		<a id="prev" href="#"></a>
		<a id="next" href="#"></a>
	</div>
	<div id="counter"></div>
</div>

<script type="text/javascript">
	function updatePrevNext(aObject){
		var prevImage = aObject.prev("a").attr("href");
		var nextImage = aObject.next("a").attr("href");
		if(prevImage) {
			$("#prev").attr("href", prevImage);
		}
		if(nextImage){
			$("#next").attr("href", nextImage);
		}
	}
	function showActivity(){
		$("#progress").show();
	}
	function hideActivity(){
		$("#progress").hide();
	}
	function updateTip() {
		$('#poza-mare[title]').qtip({
			style: {
				classes: "ui-tooltip-dark"
			},
			position: {
				at: "bottom left",
				my: "bottom left"
			}
		});
	}

	$(function(){
		showActivity();
		var firstLink = $("#grid>a:first");
		$("#panou").load(firstLink.attr("href"), function(){
			updatePrevNext(firstLink);
		});

		$("#grid>a").click(function(e){
			showActivity();
			var clickedLink = $(this);
			updatePrevNext(clickedLink);
			$("#panou").load(clickedLink.attr("href"));
			e.preventDefault();
		});
		$("#prev, #next").click(function(e){
			showActivity();
			var clickedLink = $(this);
			$("#panou").load(clickedLink.attr("href"), function(){
			});
			updatePrevNext($("#grid>a[href='"+clickedLink.attr("href")+"']"));
			e.preventDefault();
		});
	});
</script>
